<!doctype html>
<html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>Tag: cpp - Bitisle</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#3273dc"><meta name="application-name" content="Bitisle"><meta name="msapplication-TileImage" content="img/logo.png"><meta name="msapplication-TileColor" content="#3273dc"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Bitisle"><meta name="apple-mobile-web-app-status-bar-style" content="default"><link rel="apple-touch-icon" sizes="512x512" href="img/logo.png"><meta name="description" content="一倍工程師的小天地"><meta property="og:type" content="blog"><meta property="og:title" content="Bitisle"><meta property="og:url" content="https://blog.bitisle.net/"><meta property="og:site_name" content="Bitisle"><meta property="og:description" content="一倍工程師的小天地"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://blog.bitisle.net/img/open-graph.png"><meta property="article:author" content="Weida Hong"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://blog.bitisle.net/img/open-graph.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.bitisle.net"},"headline":"Bitisle","image":["https://blog.bitisle.net/img/og_image.png"],"author":{"@type":"Person","name":"Weida Hong"},"publisher":{"@type":"Organization","name":"Bitisle","logo":{"@type":"ImageObject","url":"https://blog.bitisle.net/img/logo.png"}},"description":"一倍工程師的小天地"}</script><link rel="alternate" href="/atom.xml" title="Bitisle" type="application/atom+xml"><link rel="icon" href="/img/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="Bitisle" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a><a class="navbar-item search" title="Search" href="javascript:;" rel="external nofollow noreferrer"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/tags">Tags</a></li><li class="is-active"><a href="#" aria-current="page">cpp</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2025-02-26T01:05:00.000Z" title="2/26/2025, 1:05:00 AM">2025-02-26</time></span><span class="level-item"><a class="link-muted" href="/categories/notes/">notes</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2025/02/26/cpp-generator-crtp.html">Easier Iteration with Generator</a></p><div class="content"><p>In Python, we can make a container type iterable by implement <code>__iter__</code> method.</p>
<p>For example, if we want to provide all value in a range <code>[lo, hi)</code> …</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TwoTillSix</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__iter__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">for</span> val <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">6</span>):</span><br><span class="line">            <span class="keyword">yield</span> val</span><br><span class="line"></span><br><span class="line"><span class="built_in">list</span>(TwoTillSix())  <span class="comment"># [2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>

<p>With the help of this generator function, we don’t need a separate iterator type.
Just keep the state during iteration directly in some local variable.</p>
<p>In this post, let’s see how we can do this in C++, with the help of <code>std::generator&lt;T&gt;</code>.</p>
<p>A shorter version of this post can be found in Gist and Compiler Explorer.</p>
<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://gist.github.com/wdhongtw/aa61b9b4dd132ffeae64d9189e9ba2cc">https://gist.github.com/wdhongtw/aa61b9b4dd132ffeae64d9189e9ba2cc</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://godbolt.org/z/K57Enfhcr">https://godbolt.org/z/K57Enfhcr</a></li>
</ul>
<h2 id="Coroutine-and-Concurrent-Programming"><a href="#Coroutine-and-Concurrent-Programming" class="headerlink" title="Coroutine and Concurrent Programming"></a>Coroutine and Concurrent Programming</h2><p>What happens in the example above is that Python interpreter binds the execution state of
that function to a generator object. Every time we want a value from that generator,
the execution resumes until the function yields the next value (or returns).</p>
<p>This is doable because Python provide a builtin support for <strong>coroutine, an interruptible&#x2F;resumable
function</strong>, so the control flow can interleave between callee and caller functions. And that’s the
primitive building block of concurrent programming.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">values = TwoTillSix()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> val <span class="keyword">in</span> values:</span><br><span class="line">    <span class="built_in">print</span>(val)</span><br><span class="line">    <span class="keyword">if</span> val == <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># Print 2 and 3. The body of `TwoTillSix.__iter__` is only executed twice.</span></span><br></pre></td></tr></table></figure>

<p>As we can see here, the generator makes it possible that some values are evaluated lazily,
and we can even stop the evaluation any time when we lost the interest.
All of this is possible because the support of coroutine.</p>
<h2 id="C-Coroutine-and-std-generator"><a href="#C-Coroutine-and-std-generator" class="headerlink" title="C++ Coroutine and std::generator"></a>C++ Coroutine and <code>std::generator</code></h2><p>Fortunately, C++ has language level support for coroutine since C++20.
When compiler see a function using new keywords <code>co_await</code> &#x2F; <code>co_yield</code> and <code>co_return</code>,
it will generate corresponding code to provide the ability of partial execution, and the storage
of state for that function when it’s interrupted.</p>
<p>Also, starting from C++23, <code>std::generator</code> is included in standard library. As the
coroutine (promise-)type that capture the common usage of… yes, generator!!
(Actually I’m surprised that there is no any high-level coroutine type in standard library
when coroutine is accepted as a language feature when C++20 is finalized.)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::generator&lt;<span class="type">int</span>&gt; <span class="title">fibonacci</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">1</span>, b = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">co_yield</span> a;</span><br><span class="line">        b = std::<span class="built_in">exchange</span>(a, a + b);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : <span class="built_in">fibonacci</span>()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (num &gt; <span class="number">10</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        std::<span class="built_in">println</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, num); <span class="comment">// prints 1 1 2 3 5 8</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>When <code>fibonacci</code> is called here, an interruptible function is created, and wrapped in the
<code>std::generator</code> return value. Every time we take next value out in the for-loop, the function
resumes and yield next value (and is interrupted again).</p>
<p>So now we have the ability to interleave control flow, just like the example in Python earlier!!
But… that’s a free function, usually what we encounter is a container class.
A class must has <code>begin</code>&#x2F;<code>end</code> method, and corresponding increment&#x2F;dereference operator on
the returned iterator type, in order to be iterable.
(It’s modeled as named requirements <em>Container</em> in standard.)
If a class need another method call to be iterated on, it just looks… not like C++.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Factorial</span> &#123; <span class="comment">// a virtual container for factorial series</span></span><br><span class="line">    <span class="function">std::generator&lt;<span class="type">int</span>&gt; <span class="title">generate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> product = <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> val = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">co_yield</span> product;</span><br><span class="line">            product *= val++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Factorial fac &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> num : fac.<span class="built_in">generate</span>()) &#123; <span class="comment">// well.. can we iterate on fac directly?</span></span><br><span class="line">        <span class="keyword">if</span> (num &gt; <span class="number">10</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        std::<span class="built_in">println</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, num);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>So… can we keep the implementation simple (using <code>std::generator</code> coroutine type),
while keeping the container being iterated in usual way?</p>
<h2 id="CRTP-Curiously-Recurring-Template-Pattern"><a href="#CRTP-Curiously-Recurring-Template-Pattern" class="headerlink" title="CRTP: Curiously Recurring Template Pattern"></a>CRTP: Curiously Recurring Template Pattern</h2><p>Now our goal become clear:</p>
<blockquote>
<p>How can we make a class be used as before, if the class only provides a method
that return a <code>std::generator</code>?”</p>
</blockquote>
<p>That’s the place where we adopt CRTP to solve problem.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// @brief HasGenerator identifies the customization point of CRTP base AutoContainer.</span></span><br><span class="line"><span class="comment">/// @tparam C the child class type.</span></span><br><span class="line"><span class="comment">/// @tparam T the value type.</span></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> C, <span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">concept</span> HasGenerator = <span class="built_in">requires</span>(C c) &#123;</span><br><span class="line">    &#123; c.<span class="built_in">generate</span>() &#125; -&gt; std::same_as&lt;std::generator&lt;T&gt;&gt;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// @brief A CRTP base type that allow easy iteration implementation.</span></span><br><span class="line"><span class="comment">/// @tparam T the value type of element being iterated. Not child class type.</span></span><br><span class="line"><span class="comment">/// @details Child class must provide std::generator&lt;T&gt; generate() member function.</span></span><br><span class="line"><span class="keyword">template</span> &lt;std::semiregular T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">AutoContainer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Iter</span> &#123;</span><br><span class="line">        std::generator&lt;T&gt; gen_;</span><br><span class="line">        std::ranges::<span class="type">iterator_t</span>&lt;std::generator&lt;T&gt;&gt; iter_;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="built_in">Iter</span>(std::generator&lt;T&gt;&amp;&amp; gen)</span><br><span class="line">            : gen_ &#123; std::<span class="built_in">move</span>(gen) &#125; <span class="comment">// ensure generator being alive</span></span><br><span class="line">            , iter_ &#123; gen_.<span class="built_in">begin</span>() &#125; &#123; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">bool</span> <span class="keyword">operator</span>==(<span class="type">const</span> std::<span class="type">default_sentinel_t</span>&amp;) <span class="type">const</span> &#123; <span class="keyword">return</span> iter_ == gen_.<span class="built_in">end</span>(); &#125;</span><br><span class="line">        Iter&amp; <span class="keyword">operator</span>++() &#123; <span class="keyword">return</span> ++iter_, *<span class="keyword">this</span>; &#125;</span><br><span class="line">        T <span class="keyword">operator</span>*() <span class="type">const</span> &#123; <span class="keyword">return</span> *iter_; &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// deducing-this so that we can do CRTP.</span></span><br><span class="line">    <span class="comment">// Also use concept to give better error message when doing mistake.</span></span><br><span class="line">    <span class="function">Iter <span class="title">begin</span><span class="params">(<span class="keyword">this</span> HasGenerator&lt;T&gt; <span class="keyword">auto</span>&amp;&amp; self)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Iter</span>(self.<span class="built_in">generate</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// deducing-this not required, just be symmetric with begin.</span></span><br><span class="line">    <span class="function">std::<span class="type">default_sentinel_t</span> <span class="title">end</span><span class="params">(<span class="keyword">this</span> <span class="keyword">auto</span>&amp;&amp; self)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> std::default_sentinel;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><code>AutoContainer</code> can inherited by any class that want the all the implementation for iteration.
The base class here provides an iterator type to capture the generator, and forwards the
increment&#x2F;dereference operation to it. With this iterator type, the remain
effort is on the <code>begin</code> method, just construct the iterator from <code>self.generate()</code>.
Here <code>self</code> is typed by deducing-this so <code>generate()</code> can be provided later by child class.
And that’s the place where the base class connects to it’s child.</p>
<p>Also at the <code>begin</code> method, we add concept constrain <code>HasGenerator</code>.
This way we can avoid error waterfall when using templated library.
And the interesting thing here is: “The thing to be templated so that we achieve CRTP,
is the templated <code>begin</code> method, not the <code>AutoContainer</code> class itself.
If there are two child class both  inherit from <code>AuthContainer&lt;int&gt;</code>,
only one <code>AuthContainer</code> type is instantiated, but two different <code>begin</code> are instantiated.</p>
<p>(See also: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://en.cppreference.com/w/cpp/language/crtp">Curiously Recurring Template Pattern - cppreference.com</a>)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// @brief Factorial sequence generator.</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Factorial</span> : <span class="keyword">public</span> AutoContainer&lt;<span class="type">int</span>&gt; &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Implement `generate` so this class can be iterated like a container.</span></span><br><span class="line">        <span class="function">std::generator&lt;<span class="type">int</span>&gt; <span class="title">generate</span><span class="params">()</span> <span class="type">const</span> </span>&#123;</span><br><span class="line">            <span class="comment">// The mutable state is the local variable of this coroutine,</span></span><br><span class="line">            <span class="comment">// so the method receiver can be const.</span></span><br><span class="line">            <span class="type">int</span> product = <span class="number">1</span>;</span><br><span class="line">            <span class="type">int</span> val = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="keyword">co_yield</span> product;</span><br><span class="line">                product *= val++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> Factorial fac &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> value : fac) &#123; <span class="comment">// noticed that we don&#x27;t call generate() here</span></span><br><span class="line">        <span class="keyword">if</span> (value &gt; <span class="number">10</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        std::<span class="built_in">println</span>(<span class="string">&quot;&#123;&#125;&quot;</span>, value); <span class="comment">// prints 1, 1, 2, 6</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now we can use the <code>AutoContainer</code> by inherit it in any child class.
In the example above, <code>Factorial</code> inherit from <code>AutoContainer&lt;int&gt;</code> (since it generates integers).
All we need to do is implement the <code>generate</code> method. Being a coroutine, the logic is clean.</p>
<p>Now everything works and <strong>looks nice</strong>!! :D</p>
<p>To make this class recognized as a <code>std::ranges::input_range</code>, that is, to make this class
works with <code>&lt;ranges&gt;</code> library, the base <code>AutoContainer</code> actually need more stuffs, like
<code>value_type</code>&#x2F;<code>difference_type</code> on it’s iterator, support of post-increment operator, and so on…
But that’s probably too much in a tutorial, so let’s stop here.</p>
<h2 id="More-Standard-Library-Support-Maybe"><a href="#More-Standard-Library-Support-Maybe" class="headerlink" title="More Standard Library Support, Maybe?"></a>More Standard Library Support, Maybe?</h2><p>We describe the minimal concept about coroutine, one important application of coroutine as
Generator (<code>std::generator</code>), and how to use it in a beautiful way.
But there is another important application of coroutine: Promise (with Event Loop).</p>
<p>JS developers already get used to the <code>Promise</code> type (or maybe the <code>async</code>&#x2F;<code>await</code> keyword).
Python also support this kind of usage since Python 3.5.
But unfortunately, there is still no such thing in C++ standard library, even if the coroutine
is standardized in C++20.</p>
<p>The good news is that there is already a proposal P2300 and a reference implementation <code>NVIDIA/stdexec</code>.
(They don’t use the term Promise, probably because <code>promise_type</code> already have other meaning
in the context of C++ coroutine)</p>
<p>Hope we can see more usage about these in the future.</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-11-25T22:25:00.000Z" title="11/25/2024, 10:25:00 PM">2024-11-26</time></span><span class="level-item"><a class="link-muted" href="/categories/news/">news</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/11/25/cpp-blank-identifier.html">The True Placeholder Symbol in C++</a></p><div class="content"><p>In many programming language, the common way to indicate that the symbol is not important,
is to use <code>_</code> for the symbol.</p>
<p>It was just a convention in C++, but it will become a language feature start from C++26.</p>
<p>Well… what’s the difference?</p>
<hr>
<p>We use <code>_</code> when there is some declaration but we do not care the name &#x2F; have no good name for
the variable.</p>
<p>For example, a common trick to preserve the life time of RAII lock is</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">doJob</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> std::mutex mutex;</span><br><span class="line">    std::lock_guard _(mutex); <span class="comment">// give it a name so it won&#x27;t unlock immediately</span></span><br><span class="line">    <span class="comment">// some jobs ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Or in structure-binding statement.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;std::regular T&gt;</span><br><span class="line"><span class="function">std::tuple&lt;T, <span class="type">bool</span>&gt; <span class="title">someJob</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; &#123;&#125;, <span class="literal">true</span> &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> [_, done] = <span class="built_in">someJob</span>&lt;<span class="type">int</span>&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The problem is… in C++, this style is just a convention, <code>_</code> is still a regular variable.
So if we want to ignore two value with different type, it does not work since the type mismatch.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> [_1, done1] = <span class="built_in">someJob</span>&lt;<span class="type">int</span>&gt;();</span><br><span class="line">    <span class="keyword">auto</span> [_2, done2] = <span class="built_in">someJob</span>&lt;std::string&gt;();</span><br><span class="line">    <span class="comment">// we need to separate _2 from _1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>That’s frustrating, especially for people with experience of pattern-matching expression in
other languages.</p>
<p>So in C++26 (proposed by P2169), now we can new way to interpret the semantic of <code>_</code>.</p>
<p>The rule is simple.</p>
<blockquote>
<p>If there is only one declaration of <code>_</code> in some scope, everything is same as before.</p>
</blockquote>
<p>A we can reference it later if we wan’t, although it’s probably a bad smell to use <code>_</code> in this case.</p>
<blockquote>
<p>If there are more declarations of <code>_</code>, they all refer to different objects respectively.</p>
</blockquote>
<p>In this case, they can only be assigned to. Try to use them is a compiling error.</p>
<p>And we can finally write something that looks more natural.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">auto</span> [_, done1] = <span class="built_in">someJob</span>&lt;<span class="type">int</span>&gt;();</span><br><span class="line">    <span class="keyword">auto</span> [_, done2] = <span class="built_in">someJob</span>&lt;std::string&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>Golang has this feature from the beginning, is called <em>blank identifier</em>.
For Python, although being a dynamic-type language, there is no problem to do use <code>_</code> for different
type value. <code>_</code> is defined as a wildcard when pattern-matching is introduced to Python (PEP 634).</p>
<p>It’s happy to see this came to C++ now. :D</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2024-10-23T00:15:00.000Z" title="10/23/2024, 12:15:00 AM">2024-10-23</time></span><span class="level-item"><a class="link-muted" href="/categories/notes/">notes</a></span></div></div><p class="title is-3 is-size-4-mobile"><a class="link-muted" href="/2024/10/23/cpp-optional-monostate.html">There is No Unit Type in C++</a></p><div class="content"><p>There is NO unit type in C++. (Not in core language spec, at least.)</p>
<h2 id="A-Story"><a href="#A-Story" class="headerlink" title="A Story"></a>A Story</h2><p>Assuming we are define a abstract interface for storage to get name &#x2F; set name for some user.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Storage</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Storage</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> std::string <span class="title">GetName</span><span class="params">(<span class="type">int</span> id)</span> <span class="type">const</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">SetName</span><span class="params">(<span class="type">int</span> id, std::string name)</span> <span class="type">const</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Simple and straightforward.</p>
<p>But it’s intended to be a storage accessed through network, so any operation on it is
inherently going to fail at some time.
Also, We are 2024 now, loving FP, preferring expression over statement, monadic operation
being so cool.
Thus we decide to wrap all return type in <code>std::optional</code> to indicate these actions may fail.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Storage</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Storage</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> std::optional&lt;std::string&gt; <span class="title">GetName</span><span class="params">(<span class="type">int</span> id)</span> <span class="type">const</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> std::optional&lt;<span class="type">void</span>&gt; <span class="title">SetName</span><span class="params">(<span class="type">int</span> id, std::string name)</span> <span class="type">const</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Looks good! But now it fails to be compiled.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">...\include\optional(100,26): error C2182: &#x27;_Value&#x27;: this use of &#x27;void&#x27; is not valid</span><br></pre></td></tr></table></figure>

<p>Well. template stuff.</p>
<h2 id="What-Happened"><a href="#What-Happened" class="headerlink" title="What Happened?"></a>What Happened?</h2><p>The problem is that <code>void</code> is an incomplete type in C&#x2F;C++, and always to be treat specially
when we are trying to use them.</p>
<p>By incomplete in C&#x2F;C++, we mean a type that the size of which is not (yet) known.</p>
<p>For example, if we forward declare a struct type, and later define it’s member. The struct type
is incomplete before the definition.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Item</span>;</span><br><span class="line"></span><br><span class="line">Item item; <span class="comment">// &lt;- invalid usage, since that the size of Item is unknown yet.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Item</span> &#123;</span><br><span class="line">    <span class="type">int</span> price;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Item item; <span class="comment">// &lt;- valid usage here.</span></span><br></pre></td></tr></table></figure>

<p>And <code>void</code> is a type that is impossible to be complete by specification.</p>
<p>But we can have a function that return <code>void</code>?
Well, we return <em>nothing</em></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span>; &#125; <span class="comment">// Or explicit return, both equivalent.</span></span><br></pre></td></tr></table></figure>

<p>BTW, C before C23 prefer putting a <code>void</code> in parameter list to indicate that a function takes
<em>nothing</em>, e.g. <code>int bar(void)</code>, but is’s kinda broken design here.</p>
<p>Since that we can not evaluate <code>bar(foo())</code>. There is no such thing that is a <code>void</code> and exists.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">bar</span><span class="params">(<span class="type">void</span>)</span> </span>&#123; <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bar</span>(<span class="built_in">foo</span>()); <span class="comment">// &lt;- invalid expression here.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>So back to our problem here <code>std::optional&lt;void&gt;</code></p>
<p>Conceptually, <code>std::optional&lt;T&gt;</code> is just a some T with additional information of <em>value-existence</em>.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">MyOptional</span> &#123;</span><br><span class="line">    T value;</span><br><span class="line">    <span class="type">bool</span> hasValue;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Because that there is impossible to have a member <code>void value</code>,
<code>std::optional&lt;void&gt;</code> is not going to be a valid type at first place.</p>
<p>(Well, we can make a specialization for <code>void</code>, but that’s another story.)</p>
<h2 id="So-How-can-We-Fix"><a href="#So-How-can-We-Fix" class="headerlink" title="So, How can We Fix?"></a>So, How can We Fix?</h2><p>The problem here is that there is no a valid value for <code>void</code> in C&#x2F;C++.
At some level, program can be though of a bunch of expressions. An running a program
is just the evaluation of these expressions. (Also the side effects, for real products &#x2F; services)</p>
<p>The atom of expression is value. If there is a concept that’s not possible to be express
as a value, we are kicking ourselves.</p>
<p>Take Python for example, if we have a function that return nothing, then the function actually
<strong>returns</strong> <code>None</code> when it exits.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">foo</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(foo() <span class="keyword">is</span> <span class="literal">None</span>) <span class="comment"># check pass here</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">foo</span>(<span class="params">arg: <span class="literal">None</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bar</span>(<span class="params">arg: <span class="literal">None</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">bar(foo(<span class="literal">None</span>)) <span class="comment"># well.. if we really want to chain them together</span></span><br></pre></td></tr></table></figure>

<p>So <em>nothing</em> itself is a thing, in Python, we call it <code>None</code>.
Every expression now is evaluated to some value that exists, the the type system build up that
is complete at any case.</p>
<p>The concept of <em>nothing</em> itself here is call <strong>unit type</strong> in type theory.
It’s a type that has one and only one value.
In Python, the value is <code>None</code>, in JavaScript it’s <code>null</code>, in Golang … maybe <code>struct&#123;&#125;&#123;&#125;</code> is a
good choice, although not standardized by the language.</p>
<h2 id="Unit-Type-in-C"><a href="#Unit-Type-in-C" class="headerlink" title="Unit Type in C++"></a>Unit Type in C++</h2><p>Now is the time for C++. As we already see, <code>void</code> is not a good choice for unit type because we
can not have a value for it. Are there other choices here?</p>
<p>Just define a empty struct and use it probably not a good choice, since that
now our custom unit type is not compatible with unit type from other code in the product code base.</p>
<p>How about <code>nullptr</code>, that’s the only one value for <code>std::nullptr_t</code>.
(So the type is <code>std::optional&lt;std::nullptr_t&gt;</code>).
It’s a feasible choice, but looks weird since that pointer implies indirect access semantic,
but it’s not the case when using with <code>std::optional&lt;T&gt;</code> here.</p>
<p>How about using <code>std::nullopt_t</code>? It’s also a unit type but it’s now more confusing.
What’s does it mean by <code>std::optional&lt;std::nullopt_t&gt;</code>? A optional with empty option?
There is a static assert in <code>std::optional&lt;T&gt;</code> template that forbid this usage directly,
probably because it’s too confusing.</p>
<p>Maybe <code>std::tuple&lt;&gt;</code>? A tuple with zero element, so it have only one value, the empty tuple.
That seems to be a good choice because the canonical unit type in Haskell is <code>()</code> the empty tuple.
So it looks natural for people came from Haskell.
But personally I don’t like this either since that now the type has nested angle bracket
as <code>std::optional&lt;std::tuple&lt;&gt;&gt;</code>.</p>
<p>There is a type called <code>std::monostate</code>, arrived at the same time as <code>std::optional</code> in C++17.
This candidate do not have additional implication by it’s type or it’s name.
It’s <em>monostate</em>! Just a little wordy.</p>
<p><code>std::monostate</code> is originally designed to solve the problem for a <code>std::variant&lt;...&gt;</code> to be
default initialized with any value. But it’s name and it’s characteristic are all fit our
requirement here. Thus a good choice for wrapping a function that may fail but
return nothing.</p>
<p>Now the interface looks like</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Storage</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Storage</span>() = <span class="keyword">default</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> std::optional&lt;std::string&gt; <span class="title">GetName</span><span class="params">(<span class="type">int</span> id)</span> <span class="type">const</span> </span>= <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> std::optional&lt;std::monostate&gt; <span class="title">SetName</span><span class="params">(<span class="type">int</span> id, std::string name)</span> <span class="type">const</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Hmm… <code>std::optional&lt;std::monostate&gt;</code>, which takes 29 characters.
C++ is not easy. Just like we use <code>std::shared_ptr&lt;T&gt;</code> all over the places.</p>
<p>Maybe the C++ Standards Committee should specialize <code>std::optional&lt;void&gt;</code>,
just like <code>std::expected&lt;void&gt;</code> in C++23.</p>
<hr>
<p>Wish someday <code>void</code> can be a REAL unit type in C&#x2F;C++. :D</p>
</div></article></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://avatars.githubusercontent.com/u/16065489" alt="Weida"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Weida</p><p class="is-size-6 is-block">Researcher &amp; Developer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Taiwan</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">27</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">3</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">39</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/wdhongtw" target="_blank" rel="noopener">Follow</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/wdhongtw"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://www.facebook.com/wdhongtw"><i class="fab fa-facebook"></i></a></div></div></div><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/news/"><span class="level-start"><span class="level-item">news</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/notes/"><span class="level-start"><span class="level-item">notes</span></span><span class="level-end"><span class="level-item tag">18</span></span></a></li><li><a class="level is-mobile" href="/categories/tips/"><span class="level-start"><span class="level-item">tips</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-06-28T13:22:00.000Z">2025-06-28</time></p><p class="title"><a href="/2025/06/28/easier-shpool.html">Make shpool Easier to Use</a></p><p class="categories"><a href="/categories/tips/">tips</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-02-26T01:05:00.000Z">2025-02-26</time></p><p class="title"><a href="/2025/02/26/cpp-generator-crtp.html">Easier Iteration with Generator</a></p><p class="categories"><a href="/categories/notes/">notes</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-02-04T14:10:00.000Z">2025-02-04</time></p><p class="title"><a href="/2025/02/04/javascript-proxy.html">The Backbone of Frontend Framework</a></p><p class="categories"><a href="/categories/notes/">notes</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-11-25T22:25:00.000Z">2024-11-26</time></p><p class="title"><a href="/2024/11/25/cpp-blank-identifier.html">The True Placeholder Symbol in C++</a></p><p class="categories"><a href="/categories/news/">news</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2024-10-23T00:15:00.000Z">2024-10-23</time></p><p class="title"><a href="/2024/10/23/cpp-optional-monostate.html">There is No Unit Type in C++</a></p><p class="categories"><a href="/categories/notes/">notes</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2025/"><span class="level-start"><span class="level-item">2025</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2024/"><span class="level-start"><span class="level-item">2024</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2022/"><span class="level-start"><span class="level-item">2022</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/"><span class="level-start"><span class="level-item">2021</span></span><span class="level-end"><span class="level-item tag">10</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/"><span class="level-start"><span class="level-item">2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/"><span class="level-start"><span class="level-item">2019</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2018/"><span class="level-start"><span class="level-item">2018</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/authentication/"><span class="tag">authentication</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/blog/"><span class="tag">blog</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/c/"><span class="tag">c</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ceph/"><span class="tag">ceph</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/community/"><span class="tag">community</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/cpp/"><span class="tag">cpp</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/development/"><span class="tag">development</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/docker/"><span class="tag">docker</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/email/"><span class="tag">email</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/fido/"><span class="tag">fido</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/functional/"><span class="tag">functional</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/generic/"><span class="tag">generic</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">git</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/github/"><span class="tag">github</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gitlab/"><span class="tag">gitlab</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/gnupg/"><span class="tag">gnupg</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/golang/"><span class="tag">golang</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ide/"><span class="tag">ide</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/javascript/"><span class="tag">javascript</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jekyll/"><span class="tag">jekyll</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/kubernetes/"><span class="tag">kubernetes</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/log/"><span class="tag">log</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/mq/"><span class="tag">mq</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/nats/"><span class="tag">nats</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/python/"><span class="tag">python</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/rfc/"><span class="tag">rfc</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/samba/"><span class="tag">samba</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/secret/"><span class="tag">secret</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/security/"><span class="tag">security</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/shell/"><span class="tag">shell</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/socks/"><span class="tag">socks</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/spell/"><span class="tag">spell</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ssh/"><span class="tag">ssh</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/systemd/"><span class="tag">systemd</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/terminal/"><span class="tag">terminal</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/testing/"><span class="tag">testing</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/typing/"><span class="tag">typing</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vim/"><span class="tag">vim</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/vscode/"><span class="tag">vscode</span><span class="tag">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="Bitisle" height="28"></a><p class="is-size-7"><span>&copy; 2025 Weida Hong</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener external nofollow noreferrer">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener external nofollow noreferrer" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener external nofollow noreferrer" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/wdhongtw/blog"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("en");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><a id="back-to-top" title="Back to top" href="javascript:;" rel="external nofollow noreferrer"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;" rel="external nofollow noreferrer">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>